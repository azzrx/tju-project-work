# 非线性方程（组）数值解法实验分析与结果

## 1. 实验目的

本实验旨在实现并比较求解非线性方程的三种数值方法：
1. 不动点迭代法
2. Steffensen加速方法
3. Newton迭代法

通过实际编程实现和测试，深入理解不同迭代方法的收敛性、收敛速度以及适用场景，掌握非线性方程数值求解的基本技巧。

## 2. 实验原理

### 2.1 不动点迭代法

**基本思想：**
将非线性方程 $f(x) = 0$ 改写为等价形式 $x = \phi(x)$，然后从初始值 $x_0$ 开始迭代：
$$x_{k+1} = \phi(x_k), \quad k = 0, 1, 2, \ldots$$

**收敛条件：**
- 在根 $x^*$ 的邻域内，$|\phi'(x^*)| < 1$ 时，迭代法收敛
- 收敛速度：线性收敛，收敛因子为 $|\phi'(x^*)|$

**优点：**
- 实现简单，只需要一个迭代函数
- 不需要计算导数
- 对某些问题收敛稳定

**缺点：**
- 收敛速度较慢（线性收敛）
- 需要选择合适的迭代格式才能保证收敛
- 收敛性依赖于迭代函数的性质

### 2.2 Steffensen加速方法

**基本思想：**
对不动点迭代进行加速，利用Aitken加速技术提高收敛速度。

**迭代公式：**
$$x_{k+1} = x_k - \frac{(y_k - x_k)^2}{z_k - 2y_k + x_k}$$
其中 $y_k = \phi(x_k)$，$z_k = \phi(y_k)$

**收敛性质：**
- 如果不动点迭代线性收敛，Steffensen方法可以达到平方收敛
- 不需要计算导数
- 可以加速慢收敛的不动点迭代

**优点：**
- 不需要计算导数
- 收敛速度比不动点迭代快（平方收敛）
- 可以加速慢收敛的不动点迭代

**缺点：**
- 需要计算两次迭代函数值（计算量增加）
- 当分母接近零时可能不稳定
- 对初始值的选择有一定要求

### 2.3 Newton迭代法

**基本思想：**
利用函数在 $x_k$ 处的线性化来近似原函数，求解线性方程的根作为下一次迭代值。

**迭代公式：**
$$x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)}$$

**收敛性质：**
- 在单根附近，Newton方法具有平方收敛速度
- 收敛速度最快
- 需要函数在根附近可导且导数不为零

**优点：**
- 收敛速度最快（平方收敛）
- 理论成熟，应用广泛
- 对于单根收敛性很好

**缺点：**
- 需要计算函数的导数
- 当导数接近零时可能失败
- 对初始值的选择要求较高
- 可能发散或收敛到错误的根

## 3. 实验设置

### 3.1 测试函数

#### 函数1: $f(x) = x^2 - 3x + 2 - e^x = 0$

**函数性质：**
- $f(0) = 2 - 1 = 1 > 0$
- $f(1) = 1 - 3 + 2 - e = -e < 0$
- 根据零点定理，在区间 $[0, 1]$ 内存在根

**不动点迭代格式：**
$$x = \phi_1(x) = \frac{x^2 + 2 - e^x}{3}$$

**导数：**
$$f'(x) = 2x - 3 - e^x$$

**初始值选择：** $x_0 = 0.5$（区间中点）

#### 函数2: $g(x) = x^3 + 2x^2 + 10x - 20 = 0$

**函数性质：**
- $g(0) = -20 < 0$
- $g(2) = 8 + 8 + 20 - 20 = 16 > 0$
- 根据零点定理，在区间 $[0, 2]$ 内存在根

**不动点迭代格式：**
$$x = \phi_2(x) = \frac{20}{x^2 + 2x + 10}$$

**导数：**
$$g'(x) = 3x^2 + 4x + 10$$

**初始值选择：** $x_0 = 1.0$（区间中点）

### 3.2 实验参数

- **精度要求：** $\varepsilon = 10^{-8}$
- **最大迭代次数：** $K = 1000$
- **收敛判据：** $|x_{k+1} - x_k| < \varepsilon$

### 3.3 问题3：计算量比较

**问题描述：** 比较求 $e^x + 10x - 2 = 0$ 的根到三位小数所需的计算量
- 方法1：在区间 $[0,1]$ 内用二分法
- 方法2：用迭代法 $x_{k+1} = (2 - e^{x_k})/10$，取初值 $x_0 = 0$

**精度要求：** 三位小数，即 $\varepsilon = 0.0005$

## 4. 实验结果与分析

### 4.1 函数1: $f(x) = x^2 - 3x + 2 - e^x = 0$

#### 4.1.1 不动点迭代法

**迭代格式：** $x_{k+1} = \frac{x^2 + 2 - e^x}{3}$

**理论分析：**
- 在根 $x^*$ 附近，需要检查 $|\phi_1'(x^*)| < 1$ 是否成立
- $\phi_1'(x) = \frac{2x - e^x}{3}$
- 如果 $|\phi_1'(x^*)| < 1$，则线性收敛

**预期结果：**
- 如果迭代格式选择合适，应该能够收敛
- 收敛速度取决于 $|\phi_1'(x^*)|$ 的大小
- 迭代次数可能较多（线性收敛）

#### 4.1.2 Steffensen加速方法

**预期结果：**
- 使用相同的迭代函数 $\phi_1(x)$
- 收敛速度应该比不动点迭代快
- 迭代次数应该明显减少
- 达到平方收敛速度

#### 4.1.3 Newton迭代法

**迭代公式：**
$$x_{k+1} = x_k - \frac{x_k^2 - 3x_k + 2 - e^{x_k}}{2x_k - 3 - e^{x_k}}$$

**预期结果：**
- 收敛速度最快（平方收敛）
- 迭代次数最少
- 需要计算导数值
- 如果初始值选择合适，应该快速收敛

**收敛性分析：**
- 在根附近，$f'(x^*) \neq 0$ 时，Newton方法收敛
- 需要验证 $f'(x^*) \neq 0$

### 4.2 函数2: $g(x) = x^3 + 2x^2 + 10x - 20 = 0$

#### 4.2.1 不动点迭代法

**迭代格式：** $x_{k+1} = \frac{20}{x^2 + 2x + 10}$

**理论分析：**
- 该迭代格式在根附近应该满足收敛条件
- $\phi_2'(x) = \frac{-20(2x + 2)}{(x^2 + 2x + 10)^2}$
- 需要验证 $|\phi_2'(x^*)| < 1$

**预期结果：**
- 如果迭代格式选择合适，应该能够收敛
- 收敛速度线性

#### 4.2.2 Steffensen加速方法

**预期结果：**
- 加速不动点迭代
- 收敛速度提升到平方收敛
- 迭代次数减少

#### 4.2.3 Newton迭代法

**迭代公式：**
$$x_{k+1} = x_k - \frac{x_k^3 + 2x_k^2 + 10x_k - 20}{3x_k^2 + 4x_k + 10}$$

**预期结果：**
- 收敛速度最快
- 迭代次数最少
- 由于 $g'(x) = 3x^2 + 4x + 10 > 0$（对所有 $x$），导数不会为零，方法稳定

### 4.3 问题3：计算量比较

#### 4.3.1 二分法

**理论分析：**
- 二分法每次迭代将区间缩小一半
- 理论迭代次数：$n \geq \log_2\left(\frac{b-a}{\varepsilon}\right) = \log_2\left(\frac{1-0}{0.0005}\right) \approx 10.97$
- 需要约 11 次迭代
- 每次迭代需要计算 1 次函数值
- 总函数计算次数：约 11-12 次

**特点：**
- 收敛速度稳定，不依赖于函数性质
- 每次迭代只需要计算一次函数值
- 需要知道包含根的区间

#### 4.3.2 迭代法

**迭代格式：** $x_{k+1} = \frac{2 - e^{x_k}}{10}$

**理论分析：**
- 需要检查迭代函数的收敛性
- $\phi'(x) = \frac{-e^x}{10}$
- 在根附近，如果 $|\phi'(x^*)| < 1$，则收敛
- 收敛速度取决于 $|\phi'(x^*)|$ 的大小

**预期结果：**
- 如果 $|\phi'(x^*)|$ 较小（接近0），收敛较快
- 如果 $|\phi'(x^*)|$ 接近1，收敛较慢
- 每次迭代需要计算 1 次函数值（计算 $e^x$）
- 迭代次数取决于收敛因子

**比较：**
- 如果迭代法收敛较快（$|\phi'(x^*)|$ 较小），可能比二分法需要更少的函数计算
- 如果迭代法收敛较慢（$|\phi'(x^*)|$ 接近1），可能需要更多次迭代
- 二分法的优势是收敛速度可预测，不依赖于函数性质

## 5. 方法性能对比

### 5.1 收敛速度对比

| 方法 | 收敛阶 | 收敛速度 | 适用场景 |
|------|--------|----------|----------|
| 不动点迭代 | 线性（1阶） | 慢 | 迭代格式容易构造，不需要导数 |
| Steffensen加速 | 平方（2阶） | 快 | 可以加速慢收敛的不动点迭代 |
| Newton迭代 | 平方（2阶） | 最快 | 导数容易计算，初始值选择合适 |

### 5.2 计算复杂度对比

| 方法 | 每次迭代计算量 | 总计算量 | 额外要求 |
|------|----------------|----------|----------|
| 不动点迭代 | $O(1)$ 次函数值 | $O(k)$ | 无 |
| Steffensen加速 | $O(2)$ 次函数值 | $O(2k)$ | 无 |
| Newton迭代 | $O(1)$ 次函数值 + $O(1)$ 次导数值 | $O(k)$ | 需要导数 |

### 5.3 数值稳定性对比

**不动点迭代：**
- 稳定性取决于迭代格式的选择
- 如果 $|\phi'(x^*)|$ 接近1，可能收敛很慢
- 对初始值的选择有一定要求

**Steffensen加速：**
- 当分母接近零时可能不稳定
- 需要额外的数值稳定性处理
- 对初始值的选择要求较高

**Newton迭代：**
- 当 $f'(x) \approx 0$ 时可能失败
- 对初始值的选择要求很高
- 可能发散或收敛到错误的根
- 但在合适的条件下，数值稳定性好

## 6. 算法实现要点

### 6.1 不动点迭代实现

**关键点：**
- 选择合适的迭代格式 $\phi(x)$，确保 $|\phi'(x^*)| < 1$
- 设置合理的初始值
- 检查收敛条件：$|x_{k+1} - x_k| < \varepsilon$
- 设置最大迭代次数防止无限循环

### 6.2 Steffensen加速实现

**关键点：**
- 每次迭代需要计算两次 $\phi(x)$
- 检查分母 $z - 2y + x$ 是否接近零
- 如果分母太小，回退到普通不动点迭代
- 注意数值稳定性

### 6.3 Newton迭代实现

**关键点：**
- 需要同时提供函数 $f(x)$ 和导数 $f'(x)$
- 检查 $f'(x)$ 是否为零，避免除零错误
- 选择合适的初始值，确保收敛
- 可以结合其他方法（如二分法）确定初始值

## 7. 实验结论

### 7.1 方法选择建议

1. **如果函数导数容易计算且初始值选择合适：**
   - 优先选择 **Newton迭代法**
   - 收敛速度最快，效率最高

2. **如果无法计算导数或导数计算困难：**
   - 选择 **Steffensen加速方法**
   - 可以达到平方收敛，且不需要导数

3. **如果只需要简单实现或迭代格式容易构造：**
   - 可以使用 **不动点迭代法**
   - 虽然收敛较慢，但实现简单

### 7.2 实际应用考虑

1. **初始值选择：**
   - 可以通过函数图像、零点定理等方法确定初始值
   - 初始值应该足够接近根，以保证收敛

2. **迭代格式构造：**
   - 对于不动点迭代，需要将 $f(x) = 0$ 改写为 $x = \phi(x)$
   - 不同的改写方式可能影响收敛性和收敛速度
   - 需要验证 $|\phi'(x^*)| < 1$

3. **精度与效率平衡：**
   - 根据实际需求选择合适的精度要求
   - 过高的精度要求可能导致不必要的计算
   - 考虑计算成本和精度要求的平衡

4. **数值稳定性：**
   - 注意避免除零、数值溢出等问题
   - 对于病态问题，可能需要特殊处理
   - 可以结合多种方法提高稳定性

### 7.3 问题3的结论

对于问题3（$e^x + 10x - 2 = 0$）：

- **二分法：** 收敛速度可预测，约需要 11-12 次函数计算，不依赖于函数性质
- **迭代法：** 收敛速度取决于迭代函数的收敛因子，可能更快或更慢

**选择建议：**
- 如果迭代格式的收敛因子较小（$|\phi'(x^*)| \ll 1$），迭代法可能更高效
- 如果迭代格式的收敛因子接近1，二分法可能更可靠
- 在实际应用中，可以先尝试迭代法，如果收敛太慢再改用二分法

## 8. 总结

通过本次实验，我们实现了三种非线性方程数值求解方法，深入理解了它们的原理、收敛性和适用场景：

1. **不动点迭代法**实现简单，适合作为基础方法，但收敛速度较慢
2. **Steffensen加速方法**可以在不需要导数的情况下达到平方收敛，是不错的选择
3. **Newton迭代法**收敛速度最快，但需要导数信息，对初始值要求较高

在实际应用中，应根据具体问题的特点（函数性质、导数是否容易计算、精度要求等）来选择合适的数值方法。对于复杂问题，还可以考虑结合多种方法，或者使用更高级的算法（如拟Newton法、割线法等）。
